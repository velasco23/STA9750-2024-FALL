<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Which City is Adapting fastest to Electric Vehicles? – STA 9750 2024 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">



</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 2024 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Which City is Adapting fastest to Electric Vehicles?</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="table-of-contents" class="level4">
<h4 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h4>
<p><a href="">Motivation</a> <a href="">Strategies: Policies &amp; Incentives</a> <a href="">Strategies: Adoption Barriers</a> <a href="">Metrics: Charger Infrastructure</a> <a href="">Metrics: EV Adoption Trends</a> <a href="">Conclusion</a></p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction"><span style="color: cyan;">Introduction</span></h2>
<p>Transportation accounts for nearly 30% of global greenhouse gas emissions, yet electric vehicles have the potential to cut these emissions by half when powered by clean energy. As adoption rates climb, the question isn’t whether EVs will reshape our environmental and economic landscape, but which states are leading the way and setting the example for others to follow. Electric vehicles (EVs) have a history that dates back to the 19th century, when some of the first automobiles were powered by electric motors. By the early 1900s, EVs were popular for their quiet operation and ease of use, particularly in urban areas. However, the rise of internal combustion engine (ICE) vehicles, fueled by abundant and inexpensive gasoline, led to a decline in EV production and adoption. Fast forward to the late 20th century, growing concerns about air pollution, fossil fuel dependence, and climate change recognition reignited interest in EV technology. Innovations in battery technology, particularly the development of lithium-ion batteries, dramatically increased the range and efficiency of EVs while reducing costs. The revolution had a clear change of tide. Tesla’s launch of the Roadster in 2008 marked a turning point, demonstrating that EVs could be high-performing and desirable. Prior to 2008, when someone mentioned EVs you would envision a soccer mom driving a Prius, now the image changed to a convertible sport car with. This event changed the whole perception of EVs. Since then, automakers worldwide have ramped up production, spurred by advancements in battery technology, decreasing costs, and supportive government policies. Clearly, the spark was lit. In recent years, EV adoption has surged due to a combination of environmental awareness, government incentives, and technological breakthroughs. The promise of EVs lies in their ability to reduce greenhouse gas emissions by replacing fossil-fueled vehicles and offering significant long-term economic benefits. Lower operating and maintenance costs make EVs more affordable for consumers over their lifetime. Their reliance on electricity opens up opportunities for renewable energy integration, which could be a key factor in reaching clean energy goals. Additionally, EVs reduce reliance on volatile oil markets, which are influenced by foreign markets. This revolution could actually contribute positive political diplomacy by alleviating tension in the geo-political oil industry. These advantages position EVs as a cornerstone of the transition to a sustainable and economically resilient future.</p>
</section>
<section id="data-sources" class="level2">
<h2 class="anchored" data-anchor-id="data-sources"><span style="color: cyan;">Data Sources</span></h2>
<p>Our analysis will use data from multiple sources. The sources have been acquired and vetted to be from a credible source. We aimed to capture data from government website. Although, they may not always be the cleanest and geared to our specific intent, they are fact managed and maintained consistently enough for us to preference them as oppose to a one time study conducted by a university.</p>
<div class="cell">
<details class="code-fold">
<summary>USA - SHPE Data</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory and file setup</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>download_dir <span class="ot">&lt;-</span> <span class="st">"usa_shapefiles"</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(download_dir)) <span class="fu">dir.create</span>(download_dir)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># URL for the U.S. states shapefile (Census Bureau TIGER/Line Shapefiles)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://www2.census.gov/geo/tiger/GENZ2020/shp/cb_2020_us_state_20m.zip"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>zip_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(download_dir, <span class="st">"cb_2020_us_state_20m.zip"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and unzip the shapefile</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(zip_path)) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Downloading shapefile...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">GET</span>(url, <span class="fu">write_disk</span>(zip_path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Shapefile already downloaded.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shapefile already downloaded.</code></pre>
</div>
<details class="code-fold">
<summary>USA - SHPE Data</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>unzip_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(download_dir, <span class="st">"cb_2020_us_state_20m"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(unzip_dir)) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(zip_path, <span class="at">exdir =</span> unzip_dir)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shapefile using sf</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>shapefile_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(unzip_dir, <span class="st">"cb_2020_us_state_20m.shp"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shapefile_path, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out non-mainland areas</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>mainland_states <span class="ot">&lt;-</span> us_states[<span class="sc">!</span>us_states<span class="sc">$</span>NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Hawaii"</span>, <span class="st">"Alaska"</span>, <span class="st">"Puerto Rico"</span>, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"United States Virgin Islands"</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"Commonwealth of the Northern Mariana Islands"</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"Guam"</span>, <span class="st">"American Samoa"</span>), ]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simplify geometries to reduce complexity</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>mainland_states <span class="ot">&lt;-</span> <span class="fu">st_simplify</span>(mainland_states, <span class="at">dTolerance =</span> <span class="fl">0.01</span>)  <span class="co"># Adjust tolerance for detail</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>USA SHPE Data - source: https://www2.census.gov/geo/tiger/GENZ2020/shp/cb_2020_us_state_20m.zip</p>
<div class="cell">
<details class="code-fold">
<summary>DOE - City and County Energy Profiles</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">####Miles</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"C:/Users/velas/Documents/STA9750-2024-FALL/2016cityandcountymiles.xlsx"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>miles <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> file_path, <span class="at">sheet =</span> <span class="st">"Sheet1"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>miles_clean <span class="ot">&lt;-</span> miles <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_abbr, population, <span class="st">`</span><span class="at">vehicle miles traveled (miles)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="co"># Select specific columns</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_abbr) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">sum</span>(population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_miles =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">vehicle miles traveled (miles)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">miles_per_capita =</span> total_miles <span class="sc">/</span> total_population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>City and County Energy Profiles - source: https://catalog.data.gov/dataset/city-and-county-energy-profiles-60fbd</p>
<div class="cell">
<details class="code-fold">
<summary>EIA - Power Generation</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">####power generation</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>file_path_power <span class="ot">&lt;-</span> <span class="st">"C:/Users/velas/Documents/STA9750-2024-FALL/EIA_powergeneration.xlsx"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the sheet</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> file_path_power, <span class="at">sheet =</span> <span class="st">"Sheet1"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the dataset by Year, State Code, and Renewable columns</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>power_year <span class="ot">&lt;-</span> power <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Renewable) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Nameplate_Capacity =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Nameplate Capacity (Megawatts)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Power Generation - source: https://www.eia.gov/electricity/data.php</p>
<div class="cell">
<details class="code-fold">
<summary>EPA - Air Quality</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Air quality</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace 'path_to_your_file' with the actual path to your CSV file</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>air_quality_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/velas/Documents/STA9750-2024-FALL/air_quality_data_years.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>air_quality<span class="ot">&lt;-</span> air_quality_data <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span><span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(State) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Average_Value =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Air Quality - source: https://www.epa.gov/outdoor-air-quality-data/download-daily-data</p>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background"><span style="color: cyan;">Background</span></h2>
<p>This analysis delves into the transformative potential of electric vehicles (EVs) in addressing some of the most pressing environmental and economic challenges of our time. It explores the environmental benefits of EV adoption, including significant reductions in greenhouse gas emissions, improvements in air quality, and advancements in sustainable resource utilization. Simultaneously, it examines the economic implications, focusing on shifts in energy markets, and the long-term cost savings EVs provide to both consumers and society. Additionally, it investigates which state is adopting EVs the fastest, showcasing the regional leaders setting examples for sustainable development. By analyzing these dimensions, the essay highlights how EVs are shaping a cleaner, more sustainable, and economically resilient future.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/annual_emissions1.png" class="img-fluid figure-img"></p>
<figcaption>Annual Emissions 1</figcaption>
</figure>
</div>
<p>Contrary to popular belief, electric vehicles (EV) also emit greenhouse gases. The graph above indicates that EVs emit a national average of 2,727 lbs of CO2 per vehicle, while internal combustion (ICE) emit a national average of 12,594 lbs of CO2 per vehicle. Evidently, ICEs produce about 6x more CO2 than EVs when we look at their entire life cycle.</p>
<p>First, the manufacturing stage due to the energy intensive process of mining and processing materials needed for the batteries, like lithium, cobalt and nickel. When compared to internal combustion vehicles, EVs actually emit more greenhouse gases in the manufacturing stage. Which makes sense since most of the process will be similar except for the engine. The manufacturing of the battery accounts for a significant portion of greenhouse gas emissions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image21.png" class="img-fluid figure-img"></p>
<figcaption>Annual Emissions 2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image31.png" class="img-fluid figure-img"></p>
<figcaption>Annual Emissions 3</figcaption>
</figure>
</div>
<p>Second, EVs emit greenhouse gases indirectly by consuming electricity. A byproduct of electricity product is harmful emissions. It should be noted that every state produces electricity differently and their source of electricity portfolio will also be different. For example, an EV from a state that generates electricity from a clean source would emit less emissions than an EV from a state that primary generates electricity from fossil fuels. A great example would be to compare California (Image 2) vs West Virginia (Image 3), an EV from California emits an average of 1,385 lbs vs an EV from West Virginia that emits an average of 6,300 lbs. West Virginia generates 90% of their electricity from coal (Image 4).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image41.png" class="img-fluid figure-img"></p>
<figcaption>Annual Emissions 4</figcaption>
</figure>
</div>
<p>Below I have created an interactive pie chart. This chart uses EIA data to highlight the renewable profile of each state. As mentioned above, although EV release less emissions than ICEs, an EV in a state state that generates power from a non renewable source will emit more than a state that prioritize renewable gas generation.</p>
<details class="code-fold">
<summary>Energy Generation - by State</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">### interactive map - renewables per state</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>power_2023 <span class="ot">&lt;-</span> power <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, <span class="st">`</span><span class="at">State Code</span><span class="st">`</span>, Renewable) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Nameplate_Capacity =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Nameplate Capacity (Megawatts)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize data by State Code and Renewable</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>state_summary <span class="ot">&lt;-</span> power_2023 <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Renewable =</span> <span class="fu">ifelse</span>(Renewable <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Renewable"</span>, <span class="st">"Non-Renewable"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">State Code</span><span class="st">`</span>, Renewable) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Nameplate_Capacity =</span> <span class="fu">sum</span>(Total_Nameplate_Capacity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the interactive pie chart</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>pie_chart <span class="ot">&lt;-</span> state_summary <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="sc">~</span><span class="fu">ifelse</span>(Renewable <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Renewable"</span>, <span class="st">"Non-Renewable"</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="sc">~</span>Total_Nameplate_Capacity,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">insidetextorientation =</span> <span class="st">"radial"</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Energy Production by Type"</span>),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">updatemenus =</span> <span class="fu">list</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"dropdown"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">active =</span> <span class="dv">0</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">buttons =</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span>), <span class="cf">function</span>(state) {</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> state,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"restyle"</span>,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">list</span>(state_summary<span class="sc">$</span>Renewable[state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span> <span class="sc">==</span> state]),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">values =</span> <span class="fu">list</span>(state_summary<span class="sc">$</span>Total_Nameplate_Capacity[state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span> <span class="sc">==</span> state])</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the pie chart</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pie_chart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">### interactive map - renewables per state</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<pre><code>Warning: package 'plotly' was built under R version 4.4.2</code></pre>
<pre><code>Loading required package: ggplot2</code></pre>
<pre><code>
Attaching package: 'plotly'</code></pre>
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter and process data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>power_2023 <span class="ot">&lt;-</span> power <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, <span class="st">`</span><span class="at">State Code</span><span class="st">`</span>, Renewable) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Nameplate_Capacity =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Nameplate Capacity (Megawatts)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<pre><code>`summarise()` has grouped output by 'Year', 'State Code'. You can override
using the `.groups` argument.</code></pre>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize data by State Code and Renewable</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>state_summary <span class="ot">&lt;-</span> power_2023 <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Renewable =</span> <span class="fu">ifelse</span>(Renewable <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Renewable"</span>, <span class="st">"Non-Renewable"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">State Code</span><span class="st">`</span>, Renewable) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Total_Nameplate_Capacity =</span> <span class="fu">sum</span>(Total_Nameplate_Capacity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<pre><code>`summarise()` has grouped output by 'State Code'. You can override using the
`.groups` argument.</code></pre>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the interactive pie chart</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pie_chart <span class="ot">&lt;-</span> state_summary <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ly</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="sc">~</span>Renewable,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="sc">~</span>Total_Nameplate_Capacity,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"pie"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">textinfo =</span> <span class="st">"label+percent"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">insidetextorientation =</span> <span class="st">"radial"</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Energy Production by Type"</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">updatemenus =</span> <span class="fu">list</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"dropdown"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">active =</span> <span class="dv">0</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">buttons =</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span>), <span class="cf">function</span>(state) {</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> state,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"restyle"</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>              <span class="fu">list</span>(</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">list</span>(state_summary<span class="sc">$</span>Renewable[state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span> <span class="sc">==</span> state]),</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">values =</span> <span class="fu">list</span>(state_summary<span class="sc">$</span>Total_Nameplate_Capacity[state_summary<span class="sc">$</span><span class="st">`</span><span class="at">State Code</span><span class="st">`</span> <span class="sc">==</span> state])</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the plot is displayed in the HTML</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>pie_chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="plotly html-widget html-fill-item" id="htmlwidget-4a195274c50a62a346dd" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4a195274c50a62a346dd">{"x":{"visdat":{"6a7048ce7d67":["function () ","plotlyVisDat"]},"cur_data":"6a7048ce7d67","attrs":{"6a7048ce7d67":{"labels":{},"values":{},"textinfo":"label+percent","insidetextorientation":"radial","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":{"text":"Energy Production by Type"},"updatemenus":[{"type":"dropdown","active":0,"buttons":[{"label":"AK","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[11203,1098.2]]}]},{"label":"AL","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[123247.60000000001,7844.4000000000005]]}]},{"label":"AR","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[63956.799999999996,4283.6000000000004]]}]},{"label":"AZ","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[117412.39999999999,15018]]}]},{"label":"CA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[303789.20000000001,78317.600000000006]]}]},{"label":"CO","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[69023.800000000003,16456.200000000001]]}]},{"label":"CT","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[42297.599999999999,816.79999999999995]]}]},{"label":"DC","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[187.19999999999999,39.200000000000003]]}]},{"label":"DE","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[13580.799999999999,183.19999999999999]]}]},{"label":"FL","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[283468.60000000003,15693.799999999999]]}]},{"label":"GA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[150216.20000000001,12193.4]]}]},{"label":"HI","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[12381.4,1423.3999999999999]]}]},{"label":"IA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[69087.399999999994,26854.199999999997]]}]},{"label":"ID","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[13858.6,8177.3999999999996]]}]},{"label":"IL","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[182251.79999999999,18372.599999999999]]}]},{"label":"IN","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[106934.60000000001,9673.3999999999996]]}]},{"label":"KS","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[63973.400000000001,18305]]}]},{"label":"KY","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[84193.800000000003,2371.4000000000001]]}]},{"label":"LA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[113555.8,1073]]}]},{"label":"MA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[54500.599999999999,3431.7999999999997]]}]},{"label":"MD","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[49943.800000000003,2667]]}]},{"label":"ME","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[17518.599999999999,4437.3999999999996]]}]},{"label":"MI","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[120826.8,9806.3999999999996]]}]},{"label":"MN","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[64671.800000000003,12979.4]]}]},{"label":"MO","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[86375.600000000006,6085.1999999999998]]}]},{"label":"MS","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[65096.800000000003,851.20000000000005]]}]},{"label":"MT","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[18643.200000000001,8890.7999999999993]]}]},{"label":"NC","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[138899.20000000001,17500]]}]},{"label":"ND","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[29673.400000000001,9827.3999999999996]]}]},{"label":"NE","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[37599.599999999999,7791.1999999999998]]}]},{"label":"NH","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[17455.600000000002,1465.5999999999999]]}]},{"label":"NJ","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[70764.199999999997,2388.5999999999999]]}]},{"label":"NM","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[34086.200000000004,11290.200000000001]]}]},{"label":"NV","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[51549.400000000001,12496.6]]}]},{"label":"NY","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[153637.60000000001,18307.599999999999]]}]},{"label":"OH","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[120821.59999999999,6090.3999999999996]]}]},{"label":"OK","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[109686.20000000001,26235.400000000001]]}]},{"label":"OR","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[45862.599999999999,26957.400000000001]]}]},{"label":"PA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[202918.80000000002,6386.3999999999996]]}]},{"label":"RI","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[8957.7999999999993,932.60000000000002]]}]},{"label":"SC","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[99689.800000000003,5819.8000000000002]]}]},{"label":"SD","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[19160.599999999999,9771]]}]},{"label":"TN","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[87481.399999999994,6219]]}]},{"label":"TX","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[550038.79999999993,112228.8]]}]},{"label":"US","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[4472722.2000000002,649489.80000000005]]}]},{"label":"UT","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[35742,4727.6000000000004]]}]},{"label":"VA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[110148.60000000001,9009]]}]},{"label":"VT","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[2365.4000000000001,1252.5999999999999]]}]},{"label":"WA","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[76110.399999999994,49722.800000000003]]}]},{"label":"WI","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[70360.399999999994,6023.6000000000004]]}]},{"label":"WV","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[60344.400000000001,2453.1999999999998]]}]},{"label":"WY","method":"restyle","args":[{"labels":[["Non-Renewable","Renewable"]],"values":[[37171,7249]]}]}]}],"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable","Non-Renewable","Renewable"],"values":[11203,1098.2,123247.60000000001,7844.4000000000005,63956.799999999996,4283.6000000000004,117412.39999999999,15018,303789.20000000001,78317.600000000006,69023.800000000003,16456.200000000001,42297.599999999999,816.79999999999995,187.19999999999999,39.200000000000003,13580.799999999999,183.19999999999999,283468.60000000003,15693.799999999999,150216.20000000001,12193.4,12381.4,1423.3999999999999,69087.399999999994,26854.199999999997,13858.6,8177.3999999999996,182251.79999999999,18372.599999999999,106934.60000000001,9673.3999999999996,63973.400000000001,18305,84193.800000000003,2371.4000000000001,113555.8,1073,54500.599999999999,3431.7999999999997,49943.800000000003,2667,17518.599999999999,4437.3999999999996,120826.8,9806.3999999999996,64671.800000000003,12979.4,86375.600000000006,6085.1999999999998,65096.800000000003,851.20000000000005,18643.200000000001,8890.7999999999993,138899.20000000001,17500,29673.400000000001,9827.3999999999996,37599.599999999999,7791.1999999999998,17455.600000000002,1465.5999999999999,70764.199999999997,2388.5999999999999,34086.200000000004,11290.200000000001,51549.400000000001,12496.6,153637.60000000001,18307.599999999999,120821.59999999999,6090.3999999999996,109686.20000000001,26235.400000000001,45862.599999999999,26957.400000000001,202918.80000000002,6386.3999999999996,8957.7999999999993,932.60000000000002,99689.800000000003,5819.8000000000002,19160.599999999999,9771,87481.399999999994,6219,550038.79999999993,112228.8,4472722.2000000002,649489.80000000005,35742,4727.6000000000004,110148.60000000001,9009,2365.4000000000001,1252.5999999999999,76110.399999999994,49722.800000000003,70360.399999999994,6023.6000000000004,60344.400000000001,2453.1999999999998,37171,7249],"textinfo":"label+percent","insidetextorientation":"radial","type":"pie","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(255,255,255,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</section>
<section id="motivations" class="level2">
<h2 class="anchored" data-anchor-id="motivations"><span style="color: cyan;">Motivations</span></h2>
<p>The transition to electric vehicles (EVs) is driven by a combination of economic, environmental, and practical factors that vary by state. While motivations for EV adoption can be broad, this analysis focuses on three key drivers: average miles driven, air quality, and electricity prices. States where residents drive longer distances stand to benefit economically from the lower operational costs of EVs. In regions struggling with poor air quality, EVs offer a sustainable solution to reduce vehicle emissions and improve public health. Additionally, electricity prices play a crucial role in determining the affordability and appeal of EV adoption, particularly in states with low energy costs or investments in renewable energy. By examining these motivators, we can better understand the strategic incentives for states to embrace electric vehicles as part of their transportation future.</p>
<p>Here’s a structured draft for each motivator—average miles driven, air quality, and electricity prices—to help you craft strong, clear, and analytical paragraphs. Let me know if you’d like me to refine this further!</p>
<p>###1. Average Miles Driven States with higher average miles driven per capita have a strong economic and environmental incentive to adopt electric vehicles (EVs). In regions where residents rely heavily on personal vehicles for daily commutes and long-distance travel, such as rural areas or states with limited public transportation infrastructure, fuel consumption and vehicle emissions are significant concerns.</p>
<p>States with high average miles driven also face heightened environmental impacts, including greater greenhouse gas emissions and air quality degradation from traditional vehicles. By transitioning to EVs, states can mitigate these impacts while simultaneously reducing long-term transportation costs for consumers. Thus, states with above-average mileage have a unique motivation to embrace EV adoption as a strategy for improving economic efficiency and reducing reliance on fossil fuels.</p>
<div class="cell">
<details class="code-fold">
<summary>Average Miles Drive</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">####Miles</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">"C:/Users/velas/Documents/STA9750-2024-FALL/2016cityandcountymiles.xlsx"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>miles <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> file_path, <span class="at">sheet =</span> <span class="st">"Sheet1"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>miles_clean <span class="ot">&lt;-</span> miles <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_abbr, population, <span class="st">`</span><span class="at">vehicle miles traveled (miles)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="co"># Select specific columns</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_abbr) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">sum</span>(population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_miles =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">vehicle miles traveled (miles)</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">miles_per_capita =</span> total_miles <span class="sc">/</span> total_population)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Average Miles Driven Top 10</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># analysis</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>miles_map <span class="ot">&lt;-</span>miles_clean <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_abbr,miles_per_capita)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>miles_t10 <span class="ot">&lt;-</span>miles_clean <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(miles_per_capita)) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Table for top 10</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>miles_t10 <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"State"</span>, <span class="st">"Total Population"</span>, <span class="st">"Total Miles"</span>, <span class="st">"Miles Per Capita"</span>),</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Top 10 States by Miles Per Capita"</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"center"</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"steelblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 10 States by Miles Per Capita</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; background-color: gray !important;">State</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Total Population</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Total Miles</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Miles Per Capita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GA</td>
<td style="text-align: right;">4335303</td>
<td style="text-align: right;">62183953140</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">14343.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">TN</td>
<td style="text-align: right;">3936570</td>
<td style="text-align: right;">54778368124</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">13915.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AL</td>
<td style="text-align: right;">2967987</td>
<td style="text-align: right;">39320635420</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">13248.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">FL</td>
<td style="text-align: right;">10051966</td>
<td style="text-align: right;">119350862382</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">11873.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MS</td>
<td style="text-align: right;">1533204</td>
<td style="text-align: right;">17016500110</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">11098.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">NC</td>
<td style="text-align: right;">5603342</td>
<td style="text-align: right;">60474337673</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">10792.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DE</td>
<td style="text-align: right;">267450</td>
<td style="text-align: right;">2877961456</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">10760.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">MO</td>
<td style="text-align: right;">4016772</td>
<td style="text-align: right;">42760810886</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">10645.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VT</td>
<td style="text-align: right;">626177</td>
<td style="text-align: right;">6630462002</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">10588.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">IN</td>
<td style="text-align: right;">4396654</td>
<td style="text-align: right;">46053132815</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: steelblue !important;">10474.59</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Average Miles Driven Bottom 10</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>miles_b10 <span class="ot">&lt;-</span>miles_clean <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(miles_per_capita) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Table for bottom 10</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>miles_b10 <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"State"</span>, <span class="st">"Total Population"</span>, <span class="st">"Total Miles"</span>, <span class="st">"Miles Per Capita"</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Bottom 10 States by Miles Per Capita"</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"center"</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"tomato"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">background =</span> <span class="st">"gray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Bottom 10 States by Miles Per Capita</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; background-color: gray !important;">State</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Total Population</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Total Miles</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; background-color: gray !important;">Miles Per Capita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SD</td>
<td style="text-align: right;">604870</td>
<td style="text-align: right;">2608514572</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">4312.521</td>
</tr>
<tr class="even">
<td style="text-align: left;">ND</td>
<td style="text-align: right;">566629</td>
<td style="text-align: right;">2585199613</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">4562.420</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IA</td>
<td style="text-align: right;">2485995</td>
<td style="text-align: right;">13001478339</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5229.889</td>
</tr>
<tr class="even">
<td style="text-align: left;">MT</td>
<td style="text-align: right;">555049</td>
<td style="text-align: right;">3074559164</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5539.257</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WY</td>
<td style="text-align: right;">403018</td>
<td style="text-align: right;">2257874011</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5602.415</td>
</tr>
<tr class="even">
<td style="text-align: left;">DC</td>
<td style="text-align: right;">659009</td>
<td style="text-align: right;">3715895205</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5638.611</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">1143115</td>
<td style="text-align: right;">6609722833</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5782.203</td>
</tr>
<tr class="even">
<td style="text-align: left;">NE</td>
<td style="text-align: right;">1460733</td>
<td style="text-align: right;">8632545946</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">5909.736</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NY</td>
<td style="text-align: right;">19694990</td>
<td style="text-align: right;">122719867084</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">6231.020</td>
</tr>
<tr class="even">
<td style="text-align: left;">AK</td>
<td style="text-align: right;">511975</td>
<td style="text-align: right;">3193804748</td>
<td style="text-align: right; font-weight: bold; color: white !important; background-color: tomato !important;">6238.204</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Average Miles Driven USA</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the join while ensuring geometry is preserved</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>miles_map_usa <span class="ot">&lt;-</span> mainland_states <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(miles_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"STUSPS"</span> <span class="ot">=</span> <span class="st">"state_abbr"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the mainland United States and color by miles_per_capita</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> miles_map_usa) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> miles_per_capita), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Map fill to miles_per_capita</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">"Miles per Capita"</span>) <span class="sc">+</span>  <span class="co"># Use a color gradient</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Miles per Capita by State"</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># Center the title</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>  <span class="co"># Place legend on the right</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/Average Miles Drive USA Code-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>###2. Air Quality Air quality is a critical driver for EV adoption, particularly in states grappling with pollution and poor environmental health outcomes. Areas with significant urbanization, high vehicular traffic, or industries contributing to air pollution face increased risks of respiratory diseases, such as asthma, and other health concerns linked to poor air quality. Adopting electric vehicles, which produce zero tailpipe emissions, can significantly reduce levels of nitrogen oxides, particulate matter, and other pollutants commonly associated with internal combustion engines. For instance, states like California, historically plagued by wildfires that produce smog, have adopted aggressive EV policies to combat air quality issues. Cleaner air not only improves public health but also reduces healthcare costs, creating a dual incentive for policymakers to support EV adoption. Moreover, better air quality aligns with federal and state environmental targets for reducing carbon emissions, positioning EV adoption as a tool for meeting climate goals while enhancing residents’ quality of life.</p>
<div class="cell">
<details class="code-fold">
<summary>Air quality</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'hi'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hi"</code></pre>
</div>
</div>
<p>###3. Electricity Prices Electricity prices play a pivotal role in influencing a state’s decision to encourage EV adoption. States with lower electricity prices offer a cost-effective alternative to gasoline, increasing the financial attractiveness of EVs for residents. The cost per mile to operate an EV is directly tied to electricity rates, and in states with inexpensive, reliable electricity consumers stand to benefit from reduced transportation costs. This is especially true for states that generate power from renewable sources. For states investing in renewable energy, EV adoption presents an opportunity to integrate cleaner energy into the transportation sector. By leveraging existing electricity infrastructure and low prices, states can further reduce emissions and bolster energy independence. Additionally, reducing reliance on gasoline helps prevent dependency on oil-producing countries, which can promote economic and diplomatic stability. As EVs shift energy reliance to domestically produced electricity instead of imported fossil fuels, states can play a role in enhancing national energy security and fostering diplomacy. Conversely, for states with higher electricity costs, the case for EV adoption may require additional incentives, such as subsidies, time-of-use pricing, or investments in infrastructure to drive down costs over time. Nonetheless, transitioning to EVs remains an opportunity to stabilize transportation expenses, especially when compared to the volatility of fossil fuel prices.</p>
<iframe src="pie_chart.html" width="100%" height="600" style="border:none;">
</iframe>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/velasco23\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>