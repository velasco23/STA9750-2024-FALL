---
title: "Which City is Adapting fastest to Electric Vehicles? "
format: html
editor: visual
---

#### Table of Contents

[Motivation]() 
[Strategies: Policies & Incentives]() 
[Strategies: Adoption Barriers]() 
[Metrics: Charger Infrastructure]() 
[Metrics: EV Adoption Trends]() 
[Conclusion]()

## [Introduction]{style="color: cyan;"}

Transportation accounts for nearly 30% of global greenhouse gas emissions, yet electric vehicles have the potential to cut these emissions by half when powered by clean energy. As adoption rates climb, the question isn’t whether EVs will reshape our environmental and economic landscape, but which states are leading the way and setting the example for others to follow. Electric vehicles (EVs) have a history that dates back to the 19th century, when some of the first automobiles were powered by electric motors. By the early 1900s, EVs were popular for their quiet operation and ease of use, particularly in urban areas. However, the rise of internal combustion engine (ICE) vehicles, fueled by abundant and inexpensive gasoline, led to a decline in EV production and adoption. Fast forward to the late 20th century, growing concerns about air pollution, fossil fuel dependence, and climate change recognition reignited interest in EV technology. Innovations in battery technology, particularly the development of lithium-ion batteries, dramatically increased the range and efficiency of EVs while reducing costs. The revolution had a clear change of tide. Tesla’s launch of the Roadster in 2008 marked a turning point, demonstrating that EVs could be high-performing and desirable. Prior to 2008, when someone mentioned EVs you would envision a soccer mom driving a Prius, now the image changed to a convertible sport car with. This event changed the whole perception of EVs. Since then, automakers worldwide have ramped up production, spurred by advancements in battery technology, decreasing costs, and supportive government policies. Clearly, the spark was lit. In recent years, EV adoption has surged due to a combination of environmental awareness, government incentives, and technological breakthroughs. The promise of EVs lies in their ability to reduce greenhouse gas emissions by replacing fossil-fueled vehicles and offering significant long-term economic benefits. Lower operating and maintenance costs make EVs more affordable for consumers over their lifetime. Their reliance on electricity opens up opportunities for renewable energy integration, which could be a key factor in reaching clean energy goals. Additionally, EVs reduce reliance on volatile oil markets, which are influenced by foreign markets. This revolution could actually contribute positive political diplomacy by alleviating tension in the geo-political oil industry. These advantages position EVs as a cornerstone of the transition to a sustainable and economically resilient future.

## [Data Sources]{style="color: cyan;"}

Our analysis will use data from multiple sources. The sources have been acquired and vetted to be from a credible source. We aimed to capture data from government website. Although, they may not always be the cleanest and geared to our specific intent, they are fact managed and maintained consistently enough for us to preference them as oppose to a one time study conducted by a university.

```{r}
#| label: 'SHPE data for our USA graphics'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "USA - SHPE Data"

# Load required libraries
library(sf)
library(httr)
library(ggplot2)

# Directory and file setup
download_dir <- "usa_shapefiles"
if (!dir.exists(download_dir)) dir.create(download_dir)

# URL for the U.S. states shapefile (Census Bureau TIGER/Line Shapefiles)
url <- "https://www2.census.gov/geo/tiger/GENZ2020/shp/cb_2020_us_state_20m.zip"
zip_path <- file.path(download_dir, "cb_2020_us_state_20m.zip")

# Download and unzip the shapefile
if (!file.exists(zip_path)) {
  cat("Downloading shapefile...\n")
  GET(url, write_disk(zip_path, overwrite = TRUE))
} else {
  cat("Shapefile already downloaded.\n")
}

unzip_dir <- file.path(download_dir, "cb_2020_us_state_20m")
if (!dir.exists(unzip_dir)) {
  unzip(zip_path, exdir = unzip_dir)
}

# Load the shapefile using sf
shapefile_path <- file.path(unzip_dir, "cb_2020_us_state_20m.shp")
us_states <- st_read(shapefile_path, quiet = TRUE)

# Filter out non-mainland areas
mainland_states <- us_states[!us_states$NAME %in% c("Hawaii", "Alaska", "Puerto Rico", 
                                                    "United States Virgin Islands", 
                                                    "Commonwealth of the Northern Mariana Islands", 
                                                    "Guam", "American Samoa"), ]

# Simplify geometries to reduce complexity
mainland_states <- st_simplify(mainland_states, dTolerance = 0.01)  # Adjust tolerance for detail



```
USA SHPE Data - source: https://www2.census.gov/geo/tiger/GENZ2020/shp/cb_2020_us_state_20m.zip

```{r}
#| label: 'DOE - City and County Energy Profiles Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: false
#| code-summary: "DOE - City and County Energy Profiles"

library(readxl)
library(dplyr)
####Miles
file_path <- "C:/Users/velas/Documents/STA9750-2024-FALL/2016cityandcountymiles.xlsx"

# Read data
miles <- read_excel(path = file_path, sheet = "Sheet1")

miles_clean <- miles %>%
  select(state_abbr, population, `vehicle miles traveled (miles)`) %>% # Select specific columns
  group_by(state_abbr) %>%
  summarise(
    total_population = sum(population, na.rm = TRUE),
    total_miles = sum(`vehicle miles traveled (miles)`, na.rm = TRUE)
  ) %>%
  mutate(miles_per_capita = total_miles / total_population)

```

City and County Energy Profiles - source: https://catalog.data.gov/dataset/city-and-county-energy-profiles-60fbd

```{r}
#| label: 'EIA - Power Generation Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "EIA - Power Generation"

library(readxl)
library(dplyr)
####power generation
file_path_power <- "C:/Users/velas/Documents/STA9750-2024-FALL/EIA_powergeneration.xlsx"

# Read the sheet
power <- read_excel(path = file_path_power, sheet = "Sheet1")


# Summarize the dataset by Year, State Code, and Renewable columns
power_year <- power %>%
  group_by(Year, Renewable) %>%
  summarize(Total_Nameplate_Capacity = sum(`Nameplate Capacity (Megawatts)`, na.rm = TRUE)) %>%
  ungroup()

```

Power Generation - source: https://www.eia.gov/electricity/data.php

```{r}
#| label: 'EPA - Air Quality Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "EPA - Air Quality"

### Air quality
# Replace 'path_to_your_file' with the actual path to your CSV file
air_quality_data <- read.csv("C:/Users/velas/Documents/STA9750-2024-FALL/air_quality_data_years.csv", stringsAsFactors = FALSE)

air_quality<- air_quality_data %>%
  filter(Year ==2020) %>%
  group_by(State) %>%
  summarize(Average_Value = mean(Value, na.rm = TRUE)) %>%
  ungroup()

```

Air Quality - source: https://www.epa.gov/outdoor-air-quality-data/download-daily-data

## [Background]{style="color: cyan;"}

This analysis delves into the transformative potential of electric vehicles (EVs) in addressing some of the most pressing environmental and economic challenges of our time. It explores the environmental benefits of EV adoption, including significant reductions in greenhouse gas emissions, improvements in air quality, and advancements in sustainable resource utilization. Simultaneously, it examines the economic implications, focusing on shifts in energy markets, and the long-term cost savings EVs provide to both consumers and society. Additionally, it investigates which state is adopting EVs the fastest, showcasing the regional leaders setting examples for sustainable development. By analyzing these dimensions, the essay highlights how EVs are shaping a cleaner, more sustainable, and economically resilient future.

![Annual Emissions](C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/annual_emissions1.png)

Contrary to popular belief, electric vehicles (EV) also emit greenhouse gases. The graph above indicates that EVs emit a national average of 2,727 lbs of CO2 per vehicle, while internal combustion (ICE) emit a national average of 12,594 lbs of CO2 per vehicle. Evidently, ICEs produce about 6x more CO2 than EVs when we look at their entire life cycle.

First, the manufacturing stage due to the energy intensive process of mining and processing materials needed for the batteries, like lithium, cobalt and nickel. When compared to internal combustion vehicles, EVs actually emit more greenhouse gases in the manufacturing stage. Which makes sense since most of the process will be similar except for the engine. The manufacturing of the battery accounts for a significant portion of greenhouse gas emissions.

![Annual Emissions](C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image21.png)

![Annual Emissions](C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image31.png)

Second, EVs emit greenhouse gases indirectly by consuming electricity. A byproduct of electricity product is harmful emissions. It should be noted that every state produces electricity differently and their source of electricity portfolio will also be different. For example, an EV from a state that generates electricity from a clean source would emit less emissions than an EV from a state that primary generates electricity from fossil fuels. A great example would be to compare California (Image 2) vs West Virginia (Image 3), an EV from California emits an average of 1,385 lbs vs an EV from West Virginia that emits an average of 6,300 lbs. West Virginia generates 90% of their electricity from coal (Image 4).

![Annual Emissions](C:/Users/velas/OneDrive/Documents/STA9750-2024-FALL/image41.png)

Below I have created an interactive pie chart. This chart uses EIA data to highlight the renewable profile of each state. As mentioned above, although EV release less emissions than ICEs, an EV in a state state that generates power from a non renewable source will emit more than a state that prioritize renewable gas generation.

```{r}
#| label: 'Energy Generation - by State (interactive) code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Energy Generation - by State"

### interactive map - renewables per state
library(plotly)

power_2023 <- power %>%
  filter(Year == 2023) %>%
  group_by(Year, `State Code`, Renewable) %>%
  summarize(Total_Nameplate_Capacity = sum(`Nameplate Capacity (Megawatts)`, na.rm = TRUE)) %>%
  ungroup()

print(power_2023)

# Summarize data by State Code and Renewable
state_summary <- power_2023 %>%
  mutate(Renewable = ifelse(Renewable == 1, "Renewable", "Non-Renewable")) %>%
  group_by(`State Code`, Renewable) %>%
  summarize(Total_Nameplate_Capacity = sum(Total_Nameplate_Capacity, na.rm = TRUE)) %>%
  ungroup()

# Create the interactive pie chart
pie_chart <- state_summary %>%
  plot_ly(
    labels = ~ifelse(Renewable == 1, "Renewable", "Non-Renewable"),
    values = ~Total_Nameplate_Capacity,
    type = "pie",
    textinfo = "label+percent",
    insidetextorientation = "radial"
  ) %>%
  layout(
    title = list(text = "Energy Production by Type"),
    updatemenus = list(
      list(
        type = "dropdown",
        active = 0,
        buttons = lapply(unique(state_summary$`State Code`), function(state) {
          list(
            label = state,
            method = "restyle",
            args = list(
              list(
                labels = list(state_summary$Renewable[state_summary$`State Code` == state]),
                values = list(state_summary$Total_Nameplate_Capacity[state_summary$`State Code` == state])
              )
            )
          )
        })
      )
    )
  )
# Display the pie chart
pie_chart


```

## [Motivations]{style="color: cyan;"}

The transition to electric vehicles (EVs) is driven by a combination of economic, environmental, and practical factors that vary by state. While motivations for EV adoption can be broad, this analysis focuses on three key drivers: average miles driven, air quality, and electricity prices. States where residents drive longer distances stand to benefit economically from the lower operational costs of EVs. In regions struggling with poor air quality, EVs offer a sustainable solution to reduce vehicle emissions and improve public health. Additionally, electricity prices play a crucial role in determining the affordability and appeal of EV adoption, particularly in states with low energy costs or investments in renewable energy. By examining these motivators, we can better understand the strategic incentives for states to embrace electric vehicles as part of their transportation future.

Here's a structured draft for each motivator—average miles driven, air quality, and electricity prices—to help you craft strong, clear, and analytical paragraphs. Let me know if you'd like me to refine this further!

###1. Average Miles Driven States with higher average miles driven per capita have a strong economic and environmental incentive to adopt electric vehicles (EVs). In regions where residents rely heavily on personal vehicles for daily commutes and long-distance travel, such as rural areas or states with limited public transportation infrastructure, fuel consumption and vehicle emissions are significant concerns.

States with high average miles driven also face heightened environmental impacts, including greater greenhouse gas emissions and air quality degradation from traditional vehicles. By transitioning to EVs, states can mitigate these impacts while simultaneously reducing long-term transportation costs for consumers. Thus, states with above-average mileage have a unique motivation to embrace EV adoption as a strategy for improving economic efficiency and reducing reliance on fossil fuels.

```{r}
#| label: 'Average Miles Drive Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Average Miles Drive"



library(readxl)
library(dplyr)
####Miles
file_path <- "C:/Users/velas/Documents/STA9750-2024-FALL/2016cityandcountymiles.xlsx"

# Read data
miles <- read_excel(path = file_path, sheet = "Sheet1")

miles_clean <- miles %>%
  select(state_abbr, population, `vehicle miles traveled (miles)`) %>% # Select specific columns
  group_by(state_abbr) %>%
  summarise(
    total_population = sum(population, na.rm = TRUE),
    total_miles = sum(`vehicle miles traveled (miles)`, na.rm = TRUE)
  ) %>%
  mutate(miles_per_capita = total_miles / total_population)
```

```{r}
#| label: 'Average Miles Drive Top 10 Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Average Miles Driven Top 10"

library(readxl)
library(dplyr)
library(knitr)
library(kableExtra)
library(gt)

# analysis
miles_map <-miles_clean %>%
  select(state_abbr,miles_per_capita)

miles_t10 <-miles_clean %>%
  arrange(desc(miles_per_capita))

# Table for top 10
miles_t10 %>%
  kable(
    format = "html",
    col.names = c("State", "Total Population", "Total Miles", "Miles Per Capita"),
    caption = "Top 10 States by Miles Per Capita"
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  column_spec(4, bold = TRUE, color = "white", background = "steelblue") %>%
  row_spec(0, bold = TRUE, background = "gray")
```

```{r}
#| label: 'Average Miles Drive Bottom 10 Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Average Miles Driven Bottom 10"

library(readxl)
library(dplyr)
library(knitr)
library(kableExtra)
library(gt)
miles_b10 <-miles_clean %>%
  arrange(miles_per_capita)

# Table for bottom 10
miles_b10 %>%
  kable(
    format = "html",
    col.names = c("State", "Total Population", "Total Miles", "Miles Per Capita"),
    caption = "Bottom 10 States by Miles Per Capita"
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "center"
  ) %>%
  column_spec(4, bold = TRUE, color = "white", background = "tomato") %>%
  row_spec(0, bold = TRUE, background = "gray")

```


```{r}
#| label: 'Average Miles Drive USA Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Average Miles Driven USA"
# Perform the join while ensuring geometry is preserved
miles_map_usa <- mainland_states %>%
  inner_join(miles_map, by = c("STUSPS" = "state_abbr"))


# Plot the mainland United States and color by miles_per_capita
ggplot(data = miles_map_usa) +
  geom_sf(aes(fill = miles_per_capita), color = "black") +  # Map fill to miles_per_capita
  scale_fill_viridis_c(option = "plasma", name = "Miles per Capita") +  # Use a color gradient
  theme_minimal() +
  labs(
    title = "Miles per Capita by State"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5),  # Center the title
    legend.position = "right"  # Place legend on the right
  )


```

###2. Air Quality Air quality is a critical driver for EV adoption, particularly in states grappling with pollution and poor environmental health outcomes. Areas with significant urbanization, high vehicular traffic, or industries contributing to air pollution face increased risks of respiratory diseases, such as asthma, and other health concerns linked to poor air quality. Adopting electric vehicles, which produce zero tailpipe emissions, can significantly reduce levels of nitrogen oxides, particulate matter, and other pollutants commonly associated with internal combustion engines. For instance, states like California, historically plagued by wildfires that produce smog, have adopted aggressive EV policies to combat air quality issues. Cleaner air not only improves public health but also reduces healthcare costs, creating a dual incentive for policymakers to support EV adoption. Moreover, better air quality aligns with federal and state environmental targets for reducing carbon emissions, positioning EV adoption as a tool for meeting climate goals while enhancing residents' quality of life.

```{r}
#| label: 'Air quality Code'
#| code-fold: true
#| message: false 
#| warning: false
#| cache: true
#| code-summary: "Air quality"

print('hi')

```

###3. Electricity Prices Electricity prices play a pivotal role in influencing a state's decision to encourage EV adoption. States with lower electricity prices offer a cost-effective alternative to gasoline, increasing the financial attractiveness of EVs for residents. The cost per mile to operate an EV is directly tied to electricity rates, and in states with inexpensive, reliable electricity consumers stand to benefit from reduced transportation costs. This is especially true for states that generate power from renewable sources. For states investing in renewable energy, EV adoption presents an opportunity to integrate cleaner energy into the transportation sector. By leveraging existing electricity infrastructure and low prices, states can further reduce emissions and bolster energy independence. Additionally, reducing reliance on gasoline helps prevent dependency on oil-producing countries, which can promote economic and diplomatic stability. As EVs shift energy reliance to domestically produced electricity instead of imported fossil fuels, states can play a role in enhancing national energy security and fostering diplomacy. Conversely, for states with higher electricity costs, the case for EV adoption may require additional incentives, such as subsidies, time-of-use pricing, or investments in infrastructure to drive down costs over time. Nonetheless, transitioning to EVs remains an opportunity to stabilize transportation expenses, especially when compared to the volatility of fossil fuel prices.
